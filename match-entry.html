<html>

  <head>
    <title>
      Match Results Entry
    </title>
    <script>
      function validateScore(scoreField){
        if (isNaN(scoreField.value) || scoreField.value < 0)
        {
          alert(scoreField.value + " is not a valid score.");
          scoreField.focus();
          scoreField.select();
          return false;
        }
        else
        {
          return true;
        }
      }
    </script>
	
    <script>
      function validateGame(scoreField1, scoreField2){
        if (validateScore(scoreField1) && validateScore(scoreField2))
        {
            if ((scoreField1.value != '' && scoreField2.value != '') && ((scoreField1.value < 15 && scoreField2.value < 15) || Math.abs(scoreField2.value - scoreField1.value) < 2))
            {
              var game;
            
              switch (scoreField1.id){
                case 'me-game-1':
                  game = 'game 1';
                  break;
                case 'me-game-2':
                  game = 'game 2';
                  break;
                case 'me-game-3':
                  game = 'game 3';
                  break;
                case 'me-game-4':
                  game = 'game 4';
                  break;
                case 'me-game-5':
                  game = 'game 5';
                  break;
              }
        
              alert("The scores given for " + game + " are invalid. The winner must reach 15 points and win by at least 2.");
              scoreField2.focus();
              scoreField2.select();
              return false;
            }
            else
            {
              return true;
            }
        }
        else
        {
          return false;
        }
      }
    </script>
	
    <script>
      function validateForm(){
        if (!(validateGame(document.getElementById('me-game-1'), document.getElementById('opp-game-1'))
            && validateGame(document.getElementById('me-game-2'), document.getElementById('opp-game-2'))
            && validateGame(document.getElementById('me-game-3'), document.getElementById('opp-game-3'))
            && validateGame(document.getElementById('me-game-4'), document.getElementById('opp-game-4'))
            && validateGame(document.getElementById('me-game-5'), document.getElementById('opp-game-5'))))
        {
          return false;
        }
        else if ((document.getElementById('me-game-4').value != '' && document.getElementById('opp-game-4').value == '')
              || (document.getElementById('me-game-4').value == '' && document.getElementById('opp-game-4').value != ''))
        {
          alert("Inconsistent data for game 4.");
          return false;
        }
        else if ((document.getElementById('me-game-5').value != '' && document.getElementById('opp-game-5').value == '')
              || (document.getElementById('me-game-5').value == '' && document.getElementById('opp-game-5').value != ''))
        {
          alert("Inconsistent data for game 5.");
          return false;
        }
        else
        {
          // See if either player has won more than 3 matches, which is not allowed.
          var p1Wins = 0;
          var p2Wins = 0;
          
          for (var i = 1; i < 6; i++)
          {
            if (document.getElementById('me-game-' + String(i)) > document.getElementById('opp-game-' + String(i)))
            {
              p1Wins++;
            }
            else
            {
              p2Wins++;
            }
          }        
          
          if (p1Wins > 3 || p2Wins > 3)
          {
            alert('It is not possible for a player to win more than three games in a match. Please correct this problem submit the scores again.');
            return false;
          }
          
          return true;
        }
      }
    </script>
  </head>

  <body>
    <h1 align='center'>Match Result Entry</h1>
    <p><hr></p>
    
    <h2>Enter the scores of each game played into the table:</h2>
    <form name='match-results-form' id='match-results-form' action='welcome.html' method='post' onSubmit="return validateForm();">
      <table id='match-results-table' border='1' width='22.2%'>
        <tr><th align='center'></th><th align='center'>My Score</th><th align='center'>Opponent's Score</th></tr>
        <tr><th align='center'>Game 1</th>
          <td align='center'><input type='text' id='me-game-1' name='me-game-1' onChange="validateGame(this, document.getElementById('opp-game-1'));" required></td>
          <td align='center'><input type='text' id='opp-game-1' name='opp-game-1' onChange="validateGame(document.getElementById('me-game-1'), this);" required></td>
        </tr>
        <tr><th align='center'>Game 2</th>
          <td align='center'><input type='text' id='me-game-2' name='me-game-2' onChange="validateScore(this); validateGame(this, document.getElementById('opp-game-2'));" required></td>
          <td align='center'><input type='text' id='opp-game-2' name='opp-game-2' onChange="validateScore(this); validateGame(document.getElementById('me-game-2'), this);" required></td>
        </tr>
        <tr><th align='center'>Game 3</th>
          <td align='center'><input type='text' id='me-game-3' name='me-game-3' onChange="validateScore(this); validateGame(this, document.getElementById('opp-game-3'));" required></td>
          <td align='center'><input type='text' id='opp-game-3' name='opp-game-3' onChange="validateScore(this); validateGame(document.getElementById('me-game-3'), this);" required></td>
        </tr>
        <tr><th align='center'>Game 4</th>
          <td align='center'><input type='text' id='me-game-4' name='me-game-4' onChange="validateScore(this) validateGame(this, document.getElementById('opp-game-4'));;"></td>
          <td align='center'><input type='text' id='opp-game-4' name='opp-game-4' onChange="validateScore(this); validateGame(document.getElementById('me-game-4'), this);"></td>
        </tr>
        <tr><th align='center'>Game 5</th>
          <td align='center'><input type='text' id='me-game-5' name='me-game-5' onChange="validateScore(this); validateGame(this, document.getElementById('opp-game-5'));"></td>
          <td align='center'><input type='text' id='opp-game-5' name='opp-game-5' onChange="validateScore(this); validateGame(document.getElementById('me-game-5'), this);"></td>
        </tr>
      </table><br>
      <input type='submit' value='Submit'>
    </form>
  </body>

</html>